 pipeline {
     
  agent {
    kubernetes {
      label 'SpringBootRestApp'
      defaultContainer 'jnlp'
      yaml """
apiVersion: v1
kind: Pod
metadata:
labels:
  component: ci
spec:
  containers:
  - name: gradle
    image: gradle:3.5-jdk8-alpine
    command:
    - cat
    tty: true
"""
}
	}
  
    stages {
			
			stage('Unit Test') {
				steps {
					container('gradle') {
						
								echo 'I am executing unit test'
								sh '''
								chmod 777 *
								./gradlew --no-daemon clean
								./gradlew --no-daemon build
								grep -q "org.sonarqube" build.gradle
								if [ $? -gt 0 ]; then
								sed -i '' '/register plug-ins/ {a\
								plugins {id "org.sonarqube" version "8.5.1"}
								}' build.gradle
								fi


							
								'''
								
							}
						}
					} 
					
		
			
		
		
	
	
	
}
}
