def propfile

pipeline {
	agent {
    		kubernetes {
			label 'SpringBootRestApp'
			defaultContainer 'jnlp'
			yaml """
apiVersion: v1
kind: Pod
metadata:
labels:
  component: ci
spec:
  containers:
  - name: gradle
    image: gradle:3.5-jdk8-alpine
    command:
    - cat
    tty: true
"""
		}
	}
	environment {
		GRADLE_PATH = '/opt/gradle/gradle-3.5.1/bin'
		GRADLE_TASK = 'ESBAuditClient ESBAuditLog ESBErrorTranslator TaxESB FraudESB FulfillmentESB PaymentESB ESBRadial ESBAutomatedQueueRetry AlertESB OrderReconESB'
		DEPOYMENT_SERVER='10.6.74.90'
		DEPLOYMENT_USER='muleadmin'
		DEPLOYMENT_ARCHIVE_DIR='/home/muleadmin/stage/archive'
		DEPLOYMENT_STAGE_DIR='/home/muleadmin/stage'
		DEPLOYMENT_DIR='/opt/mule/latest/webapps'
		WAR_FILES='AlertESB.war FraudESB.war TaxESB.war PaymentESB.war FulfillmentESB.war ESBAuditLog.war ESBAutomatedQueueRetry.war OrderReconESB.war'
		ESB_BIN_PATH='/opt/mule/bin/esb_service'
		ESB_WAR_FOLDERS='PaymentESB ESBAuditLog OrderReconESB FraudESB TaxESB FulfillmentESB AlertESB ESBAutomatedQueueRetry'
		REQUESTID='779'
		STAGE_NAME='dev3'
		WORKSOFT_URI='http://pwwsftapp01/executionmanager/api'
		USERNAME='devopsengineering@signetjewelers.com'
		USERNAME_FEATURE_DEPLOY='muleadmin'
		HOSTS_FEATURE_DEPLOY='10.6.74.90'
		USERNAME_DEV_DEPLOY='muleadmin'
		HOSTS_DEV_DEPLOY='10.6.74.91'
		USERNAME_RELEASE='muleadmin'
		HOSTS_RELEASE_DEPLOY="'10.6.74.92' '10.6.74.93'"
	}
	stages {
		
		
		
		
		stage('Post Deploy Tests') {
			parallel {
				stage('Smoke Test') {
				when {
				expression { {(env.GIT_BRANCH == /dev/)} || {(env.GIT_BRANCH == /release/)} }
				}
					steps {
					
								container('gradle') {
									script {

											withMaven(maven: 'MAVEN-3.6.3') {
												echo "I am executing Smoke Test on target dev environment post deployment"
											}
										}
						}
					}
				}
			}
				
				
	
  	}
}
